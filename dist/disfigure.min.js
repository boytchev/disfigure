/*! disfigure v0.0.17 */
import{Vector3 as s,Box3 as t,WebGPURenderer as e,PCFSoftShadowMap as i,Scene as a,Color as r,PerspectiveCamera as o,DirectionalLight as n,Mesh as h,CircleGeometry as l,MeshLambertMaterial as c,CanvasTexture as d,Matrix3 as m,Matrix4 as u,Euler as p,Group as w,MeshPhysicalNodeMaterial as g}from"three";import{GLTFLoader as _}from"three/addons/loaders/GLTFLoader.js";import{Fn as x,mix as L,If as b,normalGeometry as v,transformNormalToView as k,positionGeometry as f,float as y,min as Y,vec3 as X,uniform as z,mat3 as S}from"three/tsl";import{SimplexNoise as P}from"three/addons/math/SimplexNoise.js";import{OrbitControls as A}from"three/addons/controls/OrbitControls.js";import E from"three/addons/libs/stats.module.js";var M=x((([s,t])=>{var e=s.sub(t.pivot).mul(t.matrix).add(t.pivot);return L(s,e,t.locus())})),R=x((([s,t])=>{var e=s.mul(t.matrix);return L(s,e,t.locus())}));function j(s){return s.vertex=v,s.fn=R,k(C(s))}var C=x((({fn:s,space:t,vertex:e})=>{var i=e.toVar();return b(t.l_arm.locus(),(()=>{i.assign(s(i,t.l_wrist)),i.assign(s(i,t.l_wrist2)),i.assign(s(i,t.l_elbow)),i.assign(s(i,t.l_arm))})),b(t.r_arm.locus(),(()=>{i.assign(s(i,t.r_wrist)),i.assign(s(i,t.r_wrist2)),i.assign(s(i,t.r_elbow)),i.assign(s(i,t.r_arm))})),b(t.l_leg.locus(),(()=>{i.assign(s(i,t.l_foot)),i.assign(s(i,t.l_ankle)),i.assign(s(i,t.l_ankle2)),i.assign(s(i,t.l_knee)),i.assign(s(i,t.l_leg2)),i.assign(s(i,t.l_leg))})),b(t.r_leg.locus(),(()=>{i.assign(s(i,t.r_foot)),i.assign(s(i,t.r_ankle)),i.assign(s(i,t.r_ankle2)),i.assign(s(i,t.r_knee)),i.assign(s(i,t.r_leg2)),i.assign(s(i,t.r_leg))})),i.assign(s(i,t.head)),i.assign(s(i,t.chest)),i.assign(s(i,t.waist)),i.assign(s(i,t.torso)),i}));const U=x((([s,t,e])=>e.smoothstep(s,t).smoothstep(0,1).smoothstep(0,1)),{edgeFrom:"float",edgeTo:"float",value:"float",return:"float"});var I=new P;function F(s,t=0,e=-1,i=1){return e+(i-e)*(I.noise(s,t)+1)/2}function O(s,t=0,e=-1,i=1){return e+(i-e)*(Math.sin(s+t)+1)/2}function T(s,t,e=0){return t*s/1e3+e}function N(t){var e=Object.assign(Object.create(t),t);return e.pivot=e.pivot.clone(),e.pivot.x*=-1,e.angle=new s,e.matrix=z(S()),e}class H{constructor(t,e){this.pivot=new s(T(e[0],t.scale,t.x),T(e[1],t.scale,t.y),T(e[2],t.scale,t.z)),this.angle=new s,this.matrix=z(S())}}class W extends H{constructor(s,t,e,i=0,a){super(s,t),this.minY=T(e[0],s.scale,s.y),this.maxY=T(e[1],s.scale,s.y),a&&(this.minX=T(a[0],s.scale,s.x),this.maxX=T(a[1],s.scale,s.x)),this.slope=Math.tan((90-i)*Math.PI/180)}mirror(){var s=N(this);return"minX"in s&&(s.minX*=-1,s.maxX*=-1),s}locus(s=f){var t=s.x,e=s.y,i=s.z;0!=this.angle&&(e=e.add(i.sub(this.pivot.z).div(this.slope)));var a=U(this.minY,this.maxY,e);return"minX"in this&&(a=a.max(U(this.minX,this.maxX,t.abs().add(e.sub(this.pivot.y))))),a}}class D extends H{constructor(s,t,e){super(s,t),this.minX=T(e[0],s.scale,s.x),this.maxX=T(e[1],s.scale,s.x)}mirror(){var s=N(this);return s.minX*=-1,s.maxX*=-1,s}locus(s=f){var t=s.x;return U(this.minX,this.maxX,t)}}class G extends D{constructor(s,t,e,i){super(s,t,e),this.minY=T(i[0],s.scale,s.y),this.maxY=T(i[1],s.scale,s.y)}locus(s=f){var t=s.x,e=s.y,i=s.y.sub(this.pivot.y).div(4,t.sign()),a=.8;return y(1).mul(U(y(this.minX).sub(i),y(this.maxX).sub(i),t)).mul(Y(U(this.minY,this.minY*a+(1-a)*this.maxY,e),U(this.maxY,this.maxY*a+(1-a)*this.minY,e))).pow(2)}}class V extends G{constructor(s,t,e,i,a=0){super(s,t,e,i),this.grown=a}locus(s=f){var t=s.x,e=s.z;if(0==this.grown)var i=s.y.sub(t.abs().mul(.2)).add(e.mul(1/6)),a=X(s.x.mul(2),s.y,s.z.min(0)).sub(X(0,this.pivot.y,0)).length().smoothstep(0,.13).pow(10);else i=s.y.sub(t.abs().mul(.2)).add(e.abs().mul(.5)),a=X(s.x.mul(2),s.y,s.z.min(0)).sub(X(0,this.pivot.y,0)).length().smoothstep(0,.065).pow(10);return y(a).mul(t.smoothstep(this.minX,this.maxX),U(this.minY,this.maxY,i).pow(2))}}class q{constructor(s,t){const e={LocusT:V,LocusX:D,LocusXY:G,LocusY:W};var i={};for(var a in t){var r=e[t[a][0]];i[a]=new r(s,...t[a].slice(1))}this.head=i.head,this.chest=i.chest,this.waist=i.waist,this.torso=i.torso,this.l_knee=i.knee,this.r_knee=i.knee.mirror(),this.l_ankle=i.ankle,this.r_ankle=i.ankle.mirror(),this.l_ankle2=i.ankleLong,this.r_ankle2=i.ankleLong.mirror(),this.l_leg2=i.legLong,this.r_leg2=i.legLong.mirror(),this.l_foot=i.foot,this.r_foot=i.foot.mirror(),this.l_leg=i.leg,this.r_leg=i.leg.mirror(),this.l_elbow=i.elbow,this.r_elbow=i.elbow.mirror(),this.l_wrist2=i.forearm,this.r_wrist2=i.forearm.mirror(),this.l_wrist=i.wrist,this.r_wrist=i.wrist.mirror(),this.l_arm=i.arm,this.r_arm=i.arm.mirror()}}var B,Z,J,K,Q,$,ss,ts,es=[];class is{constructor(s){if((B=new e({antialias:!0})).setSize(innerWidth,innerHeight),B.shadowMap.enabled=s?.shadows??!0,B.shadowMap.type=i,document.body.appendChild(B.domElement),document.body.style.overflow="hidden",document.body.style.margin="0",(Z=new a).background=new r("whitesmoke"),(J=new o(30,innerWidth/innerHeight)).position.set(0,1,4),J.lookAt(0,1,0),s?.stats&&(ts=new E,document.body.appendChild(ts.dom)),(s?.lights??1)&&((K=new n("white",1.5)).decay=0,K.position.set(0,14,7),(s?.shadows??1)&&(K.shadow.mapSize.width=2048,K.shadow.mapSize.height=K.shadow.mapSize.width,K.shadow.camera.near=1,K.shadow.camera.far=50,K.shadow.camera.left=-5,K.shadow.camera.right=5,K.shadow.camera.top=5,K.shadow.camera.bottom=-5,K.shadow.normalBias=.01,K.autoUpdate=!1,K.castShadow=!0),Z.add(K),(Q=new n("white",1.5)).decay=0,Q.target=Z,J.add(Q),Z.add(J)),(s?.controls??1)&&(($=new A(J,B.domElement)).enableDamping=!0,$.target.set(0,.8,0)),s?.ground??1){var t=document.createElement("CANVAS");t.width=128,t.height=128;var m=t.getContext("2d");m.fillStyle="white",m.filter="blur(10px)",m.beginPath(),m.arc(64,64,38,0,2*Math.PI),m.fill();var u=new h(new l(50),new c({color:"antiquewhite",transparent:!0,map:new d(t)}));u.receiveShadow=!0,u.rotation.x=-Math.PI/2,u.renderOrder=-1,Z.add(u)}window.addEventListener("resize",(()=>{J.aspect=innerWidth/innerHeight,J.updateProjectionMatrix(),B.setSize(innerWidth,innerHeight)})),B.setAnimationLoop(os)}}class as extends Event{#s;constructor(){super("animate")}get target(){return this.#s}set target(s){this.#s=s}}var rs=new as("animate");function os(s){rs.time=s,window.dispatchEvent(rs),es.forEach((s=>{s.update(),s.dispatchEvent(rs)})),ss&&ss(s),$&&$.update(),ts&&ts.update(),B.render(Z,J)}function ns(s){ss=s}const hs=import.meta.url.replace("/src/body.js","/assets/models/");var ls=new m,cs=new m,ds=new s;function ms(s,t,e,i="angle"){Object.defineProperty(s,t,{get:()=>s[i][e]/(2*Math.PI/360),set(t){s[i][e]=t*(2*Math.PI/360)}})}class us extends w{constructor(s,t,e,i,a=i,r="xyz"){super(),this.model=s,this.isRight=t,this.parent=e,this.pivot=i.pivot,this.angle=i.angle,this.matrix=i.matrix,this.angleAux=a.angle,this.nameY=r[1],this.position.copy(i.pivot),ms(this,"bend",r[0]),ms(this,"raise",r[0]),ms(this,"tilt",r[2]),ms(this,"straddle",r[2]),ms(this,"foreward",r[0]),ms(this,"turn",r[1],"angleAux")}attach(s){s.parent&&(s=s.clone());var t=new w,e=new w;t.add(e),e.add(s),e.rotation.z=this.isRight?Math.PI:0,s.position.y*=this.isRight?-1:1,t.matrixAutoUpdate=!1,t.joint=this,this.model.children[0].add(t),this.model.accessories.push(t)}}var ps=new u,ws=new p,gs=1;class _s extends w{constructor(e,i,a){super(),this.uid=gs,gs+=.3+2*Math.random(),this.castShadow=!0,this.receiveShadow=!0,this.accessories=[],this.dims={},this.space={};var r,o=new h(e.scene.children[0].geometry);!function(e,i){var a=new s,r=(new t).setFromObject(e,!0);r.getCenter(a),e.position.sub(a),i.x=a.x,i.y=r.min.y,i.z=a.z,r.getSize(a),i.scale=Math.max(...a),i.height=a.y}(o,this.dims),this.space=new q(this.dims,i),this.torso=new us(this,!1,null,this.space.torso),this.waist=new us(this,!1,this.torso,this.space.waist),this.chest=new us(this,!1,this.waist,this.space.chest),this.head=new us(this,!1,this.chest,this.space.head),this.l_leg=new us(this,!1,this.waist,this.space.l_leg,this.space.l_leg2),this.l_knee=new us(this,!1,this.l_leg,this.space.l_knee),this.l_ankle=new us(this,!1,this.l_knee,this.space.l_ankle,this.space.l_ankle2),this.l_foot=new us(this,!1,this.l_ankle,this.space.l_foot),this.r_leg=new us(this,!0,this.waist,this.space.r_leg,this.space.r_leg2),this.r_knee=new us(this,!0,this.r_leg,this.space.r_knee),this.r_ankle=new us(this,!0,this.r_knee,this.space.r_ankle,this.space.r_ankle2),this.r_foot=new us(this,!0,this.r_ankle,this.space.r_foot),this.l_arm=new us(this,!1,this.chest,this.space.l_arm,this.space.l_arm,"yxz"),this.l_elbow=new us(this,!1,this.l_arm,this.space.l_elbow,this.space.l_elbow,"yxz"),this.l_wrist=new us(this,!1,this.l_elbow,this.space.l_wrist,this.space.l_wrist2,"zxy"),this.r_arm=new us(this,!0,this.chest,this.space.r_arm,this.space.r_arm,"yxz"),this.r_elbow=new us(this,!0,this.r_arm,this.space.r_elbow,this.space.r_elbow,"yxz"),this.r_wrist=new us(this,!0,this.r_elbow,this.space.r_wrist,this.space.r_wrist2,"zxy"),o.material=new g({positionNode:(r={space:this.space},r.vertex=f,r.fn=M,C(r)),normalNode:j({space:this.space}),colorNode:X(254/255,209/255,185/255).pow(2.2),metalness:0,roughness:.6}),a&&o.scale.setScalar(a/this.dims.height),o.castShadow=!0,o.receiveShadow=!0,this.model=o,this.add(o),es.push(this),Z&&Z.add(this),this.l_arm.straddle=this.r_arm.straddle=65,this.l_elbow.bend=this.r_elbow.bend=20}update(){function s(s,t,e,i){ws.set(t*s.angle.x,e*s.angle.y,i*s.angle.z,"YZX"),ps.makeRotationFromEuler(ws);var a=ps.elements;s.matrix.value.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10])}for(var t of(s(this.space.head,-1,-1,1),s(this.space.chest,-1,-1,1),s(this.space.waist,-1,1,1),s(this.space.torso,-1,-1,1),s(this.space.l_elbow,0,1,0),s(this.space.r_elbow,0,-1,0),s(this.space.l_wrist,0,1,1),s(this.space.r_wrist,0,-1,-1),s(this.space.l_wrist2,-1,0,0),s(this.space.r_wrist2,-1,0,0),s(this.space.l_arm,-1,1,1),s(this.space.r_arm,-1,-1,-1),s(this.space.l_knee,-1,0,0),s(this.space.r_knee,-1,0,0),s(this.space.l_ankle,-1,0,-1),s(this.space.r_ankle,-1,0,1),s(this.space.l_ankle2,0,-1,0),s(this.space.r_ankle2,0,1,0),s(this.space.l_foot,-1,0,0),s(this.space.r_foot,-1,0,0),s(this.space.l_leg2,0,-1,0),s(this.space.r_leg2,0,1,0),s(this.space.l_leg,1,0,-1),s(this.space.r_leg,1,0,1),this.accessories)){var e=t.joint;for(cs.identity(),ds.copy(e.pivot);e;e=e.parent)ls.copy(e.matrix.value).transpose(),cs.premultiply(ls),ds.sub(e.pivot).applyMatrix3(ls).add(e.pivot);t.matrix.setFromMatrix3(cs),t.matrix.setPosition(ds)}}}class xs extends _s{static URL="man.glb";static SPACE={head:["LocusY",[0,878,-37],[838,923],30],chest:["LocusY",[0,661,-8],[438,929],0,[40,300]],waist:["LocusY",[0,570,-9],[310,840]],torso:["LocusY",[0,570,-9],[-1001,-1e3]],leg:["LocusT",[41,546,-19],[-2,2],[690,441]],legLong:["LocusY",[39,0,-19],[700,140]],knee:["LocusY",[50,286,-23],[341,218],20],ankle:["LocusY",[41,51,-1],[97,10],-10],ankleLong:["LocusY",[51,206,-29],[430,-10]],foot:["LocusY",[0,20,12],[111,-185],120],elbow:["LocusX",[238,815,-40],[230,260],0],forearm:["LocusX",[170,815,-38],[46,490]],wrist:["LocusX",[375,820,-40],[354,402]],arm:["LocusXY",[85,790,-40],[30,150],[600,900]]};constructor(s){super(ks,xs.SPACE,s),this.url=hs+xs.URL,this.position.y=this.dims.height/2-.015,this.l_leg.straddle=this.r_leg.straddle=5,this.l_ankle.tilt=this.r_ankle.tilt=-5,this.l_ankle.bend=this.r_ankle.bend=3}}class Ls extends _s{static URL="woman.glb";static SPACE={head:["LocusY",[0,872,-30],[827,919],30],chest:["LocusY",[0,661,-8],[438,929],0,[40,300]],waist:["LocusY",[0,570,-9],[350,840]],torso:["LocusY",[0,570,-9],[-1001,-1e3]],leg:["LocusT",[41,546,-19],[-2,2],[690,441]],legLong:["LocusY",[44,0,-19],[700,140]],knee:["LocusY",[50,286,-23],[341,218],20],ankle:["LocusY",[44,51,-4],[97,10],-10],ankleLong:["LocusY",[51,201,-29],[430,-33]],foot:["LocusY",[0,20,12],[111,-185],120],elbow:["LocusX",[238,815,-40],[230,260],0],forearm:["LocusX",[170,815,-38],[54,475]],wrist:["LocusX",[359,815,-34],[343,380]],arm:["LocusXY",[80,793,-40],[30,137],[600,900]]};constructor(s){super(fs,Ls.SPACE,s),this.url=hs+Ls.URL,this.position.y=this.dims.height/2-.005,this.l_leg.straddle=this.r_leg.straddle=-2.9,this.l_ankle.tilt=this.r_ankle.tilt=2.9,this.l_ankle.bend=this.r_ankle.bend=3}}class bs extends _s{static URL="child.glb";static SPACE={head:["LocusY",[0,850,-32],[807,894],30],chest:["LocusY",[0,640,1],[419,914],0,[40,300]],waist:["LocusY",[0,530,-7],[285,836]],torso:["LocusY",[0,530,-7],[-1001,-1e3]],leg:["LocusT",[40,521,-9],[-1,1],[625,430],1],legLong:["LocusY",[46,0,-5],[700,140]],knee:["LocusY",[50,288,-12],[346,221],20],ankle:["LocusY",[54,48,-14],[81,33],-10],ankleLong:["LocusY",[51,201,-25],[430,-33]],foot:["LocusY",[0,20,6],[83,-200],120],elbow:["LocusX",[249,793,-56],[230,273],0],forearm:["LocusX",[170,794,-59],[54,475]],wrist:["LocusX",[398,802,-57],[384,409]],arm:["LocusXY",[80,793,-40],[30,137],[600,900]]};constructor(s){super(ys,bs.SPACE,s),this.url=hs+bs.URL,this.position.y=this.dims.height/2-.005,this.l_ankle.bend=this.r_ankle.bend=3}}var vs=new _,[ks,fs,ys]=await Promise.all([vs.loadAsync(hs+xs.URL),vs.loadAsync(hs+Ls.URL),vs.loadAsync(hs+bs.URL)]);console.log("%c⋮⋮⋮ DISFIGURE v0","display: block; padding:0.5em; font-size:150%; color: crimson;");export{bs as Child,xs as Man,Ls as Woman,is as World,J as camera,Q as cameraLight,F as chaotic,$ as controls,es as everybody,K as light,O as regular,B as renderer,Z as scene,ns as setAnimationLoop};
