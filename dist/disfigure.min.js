/*! disfigure v0.0.3 */
import{Fn as t,mat3 as e,mix as n,float as a,positionGeometry as s,If as o,select as u,vec3 as r,uniform as m}from"three/tsl";import"three";const i=t((([t])=>{var n=t.cos().toVar(),a=t.sin().toVar();return e(1,0,0,0,n,a,0,a.negate(),n)})).setLayout({name:"matRotX",type:"mat3",inputs:[{name:"angle",type:"float"}]}),p=t((([t])=>{var n=t.cos().toVar(),a=t.sin().toVar();return e(n,0,a.negate(),0,1,0,a,0,n)})).setLayout({name:"matRotY",type:"mat3",inputs:[{name:"angle",type:"float"}]}),l=t((([t])=>{var n=t.cos().toVar(),a=t.sin().toVar();return e(n,a,0,a.negate(),n,0,0,0,1)})).setLayout({name:"matRotZ",type:"mat3",inputs:[{name:"angle",type:"float"}]}),h=t((([t])=>{var e=i(t.x),n=p(t.y),a=l(t.z);return n.mul(e).mul(a)})).setLayout({name:"matRotYXZ",type:"mat3",inputs:[{name:"angles",type:"vec3"}]}),y=t((([t])=>{var e=i(t.x),n=p(t.y),a=l(t.z);return n.mul(a).mul(e)})).setLayout({name:"matRotYZX",type:"mat3",inputs:[{name:"angles",type:"vec3"}]});t((([t])=>{var e=i(t.x),n=p(t.y),a=l(t.z);return e.mul(n).mul(a)})).setLayout({name:"matRotXYZ",type:"mat3",inputs:[{name:"angles",type:"vec3"}]});const g=t((([t])=>{var e=i(t.x),n=p(t.y),a=l(t.z);return e.mul(a).mul(n)})).setLayout({name:"matRotXZY",type:"mat3",inputs:[{name:"angles",type:"vec3"}]});function f({waistSpan:t}){return s.y.smoothstep(t.x,t.y)}function d({headSpan:t}){return s.y.add(s.z.div(3)).smoothstep(t.x,t.y)}function c({chestSpan:t}){return s.y.smoothstep(t.x,t.y)}function L({kneeLeftSpan:t}){return s.y.smoothstep(t.x,t.y)}function R({ankleLeftSpan:t}){return s.y.smoothstep(t.x,t.y)}function T({legLeftSpan:t}){return s.y.smoothstep(t.x,t.y).pow(1)}function v({hipLeftSpan:t}){var e=s.x,n=s.y;return n.sub(e.mul(2)).smoothstep(t.z,t.w.sub(e.mul(1.6))).mul(n.smoothstep(t.x,t.y)).mul(e.smoothstep(-.01,.01))}function x({elbowLeftSpan:t}){return s.x.smoothstep(t.x,t.y)}function w({forearmLeftSpan:t}){return s.x.smoothstep(t.x,t.y)}function P({wristLeftSpan:t}){return s.x.smoothstep(t.x,t.y)}function S({armLeftSpan:t}){var e=s.x,n=s.y;return e.smoothstep(t.x,t.y).mul(n.smoothstep(t.z,t.w))}t((([t])=>{var e=i(t.x),n=p(t.y);return l(t.z).mul(e).mul(n)})).setLayout({name:"matRotZXY",type:"mat3",inputs:[{name:"angles",type:"vec3"}]}),t((([t])=>{var e=i(t.x),n=p(t.y);return l(t.z).mul(n).mul(e)})).setLayout({name:"matRotZYX",type:"mat3",inputs:[{name:"angles",type:"vec3"}]});var k=t((([t,e,n,a])=>t.sub(e).mul(h(n.mul(a))).add(e))).setLayout({name:"jointRotate",type:"vec3",inputs:[{name:"pos",type:"vec3"},{name:"center",type:"vec3"},{name:"angle",type:"vec3"},{name:"amount",type:"float"}]}),b=t((([t,e,n,a])=>t.sub(e).mul(y(n.mul(a))).add(e))).setLayout({name:"jointRotateLeg",type:"vec3",inputs:[{name:"pos",type:"vec3"},{name:"center",type:"vec3"},{name:"angle",type:"vec3"},{name:"amount",type:"float"}]}),z=t((([t,e,s,o])=>n(t,t.sub(e).mul(g(s.mul(o))).mul(a(1).sub(o.mul(2*Math.PI).sub(Math.PI).cos().add(1).div(2).div(4).mul(s.z.cos().oneMinus()))).add(e),o.pow(.25)))).setLayout({name:"jointRotate2",type:"vec3",inputs:[{name:"pos",type:"vec3"},{name:"center",type:"vec3"},{name:"angle",type:"vec3"},{name:"amount",type:"float"}]}),q=t((({skeleton:t,posture:e})=>{var n=s.toVar(),a=S(t).toVar();o(a.greaterThan(0),(()=>{n.assign(k(n,t.wristLeftPos,e.wristLeftTurn,P(t))),n.assign(k(n,t.forearmLeftPos,e.forearmLeftTurn,w(t))),n.assign(k(n,t.elbowLeftPos,e.elbowLeftTurn,x(t))),n.assign(z(n,t.armLeftPos,e.armLeftTurn,a))}));var u=function({armRightSpan:t}){var e=s.x,n=s.y;return e.smoothstep(t.x,t.y).mul(n.smoothstep(t.z,t.w))}(t).toVar();o(u.greaterThan(0),(()=>{n.assign(k(n,t.wristRightPos,e.wristRightTurn,function({wristRightSpan:t}){return s.x.smoothstep(t.x,t.y)}(t))),n.assign(k(n,t.forearmRightPos,e.forearmRightTurn,function({forearmRightSpan:t}){return s.x.smoothstep(t.x,t.y)}(t))),n.assign(k(n,t.elbowRightPos,e.elbowRightTurn,function({elbowRightSpan:t}){return s.x.smoothstep(t.x,t.y)}(t))),n.assign(z(n,t.armRightPos,e.armRightTurn,u))})),n.assign(k(n,t.headPos,e.headTurn,d(t))),n.assign(k(n,t.chestPos,e.chestTurn,c(t))),n.assign(k(n,t.waistPos,e.waistTurn,f(t)));var r=v(t).toVar();o(r.greaterThan(0),(()=>{n.assign(k(n,t.ankleLeftPos,e.ankleLeftTurn,R(t))),n.assign(k(n,t.legLeftPos,e.legLeftTurn,T(t))),n.assign(k(n,t.kneeLeftPos,e.kneeLeftTurn,L(t))),n.assign(b(n,t.hip2LeftPos,e.hip2LeftTurn,function({hip2LeftSpan:t}){return s.y.smoothstep(t.x,t.y)}(t))),n.assign(b(n,t.hipLeftPos,e.hipLeftTurn,r))}));var m=function({hipRightSpan:t}){var e=s.x,n=s.y;return n.add(e.mul(2)).smoothstep(t.z,t.w.add(e.mul(1.6))).mul(n.smoothstep(t.x,t.y)).mul(e.smoothstep(.01,-.01))}(t).toVar();return o(m.greaterThan(0),(()=>{n.assign(k(n,t.ankleRightPos,e.ankleRightTurn,function({ankleRightSpan:t}){return s.y.smoothstep(t.x,t.y)}(t))),n.assign(k(n,t.legRightPos,e.legRightTurn,function({legRightSpan:t}){return s.y.smoothstep(t.x,t.y)}(t))),n.assign(k(n,t.kneeRightPos,e.kneeRightTurn,function({kneeRightSpan:t}){return s.y.smoothstep(t.x,t.y)}(t))),n.assign(b(n,t.hip2RightPos,e.hip2RightTurn,function({hip2RightSpan:t}){return s.y.smoothstep(t.x,t.y)}(t))),n.assign(b(n,t.hipRightPos,e.hipRightTurn,m))})),n})),V=t((({skeleton:t,posture:e})=>{var n=e.select,s=a(0).add(d(t).mul(u(n.equal(1),1,0))).add(c(t).mul(u(n.equal(2),1,0))).add(f(t).mul(u(n.equal(3),1,0))).add(v(t).mul(u(n.equal(11),1,0))).add(T(t).mul(u(n.equal(12),1,0))).add(L(t).mul(u(n.equal(13),1,0))).add(R(t).mul(u(n.equal(14),1,0))).add(S(t).mul(u(n.equal(21),1,0))).add(x(t).mul(u(n.equal(22),1,0))).add(w(t).mul(u(n.equal(23),1,0))).add(P(t).mul(u(n.equal(24),1,0))).toVar();return s.assign(u(e.isolated.equal(0),s.smoothstep(0,1).mul(2*Math.PI).sub(Math.PI).cos().add(1).div(2).pow(1/4).mul(1.1).negate(),s.clamp(0,1).pow(.75).negate())),r(0,s.div(2),s.div(1))})),X=t((()=>{var t=s,e=a(0).add(t.x.mul(72).cos().smoothstep(.9,1)).add(t.y.mul(74).cos().smoothstep(.9,1)).add(t.z.mul(74).add(t.y.mul(4.5).add(.5).cos().mul(1).add(2.5)).abs().smoothstep(.6,0)).smoothstep(.6,1).oneMinus().pow(.1);return r(e)}));function Y(){return{headTurn:m(r(0,0,0)),chestTurn:m(r(0,0,0)),waistTurn:m(r(0,0,0)),kneeLeftTurn:m(r(0,0,0)),kneeRightTurn:m(r(0,0,0)),ankleLeftTurn:m(r(0,0,0)),ankleRightTurn:m(r(0,0,0)),hipLeftTurn:m(r(0,0,0)),hip2LeftTurn:m(r(0,0,0)),hipRightTurn:m(r(0,0,0)),hip2RightTurn:m(r(0,0,0)),legLeftTurn:m(r(0,0,0)),legRightTurn:m(r(0,0,0)),elbowLeftTurn:m(r(0,0,0)),elbowRightTurn:m(r(0,0,0)),forearmLeftTurn:m(r(0,0,0)),forearmRightTurn:m(r(0,0,0)),wristLeftTurn:m(r(0,0,0)),wristRightTurn:m(r(0,0,0)),armLeftTurn:m(r(0,0,0)),armRightTurn:m(r(0,0,0))}}export{X as tslColorNode,V as tslEmissiveNode,q as tslPositionNode,Y as tslPosture};
