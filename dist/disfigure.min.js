/*! disfigure v0.0.15 */
import{Vector3 as t,Box3 as e,WebGPURenderer as s,PCFSoftShadowMap as i,Scene as a,Color as h,PerspectiveCamera as n,DirectionalLight as o,Mesh as r,CircleGeometry as l,MeshLambertMaterial as g,CanvasTexture as c,Matrix3 as m,Matrix4 as d,Euler as p,Group as L,MeshPhysicalNodeMaterial as f}from"three";import{GLTFLoader as u}from"three/addons/loaders/GLTFLoader.js";import{Fn as w,mix as x,If as R,normalGeometry as b,transformNormalToView as k,positionGeometry as Y,float as v,min as y,vec3 as X,uniform as z,mat3 as Z}from"three/tsl";import{SimplexNoise as M}from"three/addons/math/SimplexNoise.js";import{OrbitControls as S}from"three/addons/controls/OrbitControls.js";import j from"three/addons/libs/stats.module.js";var P=w((([t,e])=>{var s=t.sub(e.pivot).mul(e.matrix).add(e.pivot);return x(t,s,e.locus())})),A=w((([t,e])=>{var s=t.mul(e.matrix);return x(t,s,e.locus())}));function E(t){return t.vertex=b,t.fn=A,k(I(t)).xyz}var I=w((({fn:t,space:e,vertex:s})=>{var i=s.toVar();return R(e.armLeft.locus(),(()=>{i.assign(t(i,e.wristLeft)),i.assign(t(i,e.forearmLeft)),i.assign(t(i,e.elbowLeft)),i.assign(t(i,e.armLeft))})),R(e.armRight.locus(),(()=>{i.assign(t(i,e.wristRight)),i.assign(t(i,e.forearmRight)),i.assign(t(i,e.elbowRight)),i.assign(t(i,e.armRight))})),i.assign(t(i,e.head)),i.assign(t(i,e.chest)),i.assign(t(i,e.waist)),R(e.legLeft.locus(),(()=>{i.assign(t(i,e.footLeft)),i.assign(t(i,e.ankleLeft)),i.assign(t(i,e.ankleLongLeft)),i.assign(t(i,e.kneeLeft)),i.assign(t(i,e.legLongLeft)),i.assign(t(i,e.legLeft))})),R(e.legRight.locus(),(()=>{i.assign(t(i,e.footRight)),i.assign(t(i,e.ankleRight)),i.assign(t(i,e.ankleLongRight)),i.assign(t(i,e.kneeRight)),i.assign(t(i,e.legLongRight)),i.assign(t(i,e.legRight))})),i}));const C=w((([t,e,s])=>s.smoothstep(t,e).smoothstep(0,1).smoothstep(0,1)),{edgeFrom:"float",edgeTo:"float",value:"float",return:"float"});var F=new M;function O(t,e=0,s=-1,i=1){return s+(i-s)*(F.noise(t,e)+1)/2}function T(t,e=0,s=-1,i=1){return s+(i-s)*(Math.sin(t+e)+1)/2}function N(t,e,s=0){return e*t/1e3+s}function H(e){var s=Object.assign(Object.create(e),e);return s.pivot=s.pivot.clone(),s.pivot.x*=-1,s.angle=new t,s.matrix=z(Z()),s}class W{constructor(e,s){this.pivot=new t(N(s[0],e.scale,e.x),N(s[1],e.scale,e.y),N(s[2],e.scale,e.z)),this.angle=new t,this.matrix=z(Z())}}class U extends W{constructor(t,e,s,i=0,a){super(t,e),this.minY=N(s[0],t.scale,t.y),this.maxY=N(s[1],t.scale,t.y),a&&(this.minX=N(a[0],t.scale,t.x),this.maxX=N(a[1],t.scale,t.x)),this.slope=Math.tan((90-i)*Math.PI/180)}mirror(){var t=H(this);return"minX"in t&&(t.minX*=-1,t.maxX*=-1),t}locus(t=Y){var e=t.x,s=t.y,i=t.z;0!=this.angle&&(s=s.add(i.sub(this.pivot.z).div(this.slope)));var a=C(this.minY,this.maxY,s);return"minX"in this&&(a=a.max(C(this.minX,this.maxX,e.abs().add(s.sub(this.pivot.y))))),a}}class _ extends W{constructor(t,e,s,i=0){super(t,e),this.minX=N(s[0],t.scale,t.x),this.maxX=N(s[1],t.scale,t.x),this.slope=Math.tan((90-i)*Math.PI/180)}mirror(){var t=H(this);return t.minX*=-1,t.maxX*=-1,t}locus(t=Y){var e=t.x,s=t.z,i=v(this.minX),a=v(this.maxX);if(0!=this.angle){var h=s.sub(this.pivot.z).div(this.slope).max(.01).mul(e.sign());i=i.sub(h),a=a.add(h)}return C(i,a,e)}}class D extends _{constructor(t,e,s,i){super(t,e,s),this.minY=N(i[0],t.scale,t.y),this.maxY=N(i[1],t.scale,t.y)}locus(t=Y){var e=t.x,s=t.y,i=t.y.sub(this.pivot.y).div(4,e.sign()),a=.8;return v(1).mul(C(v(this.minX).sub(i),v(this.maxX).sub(i),e)).mul(y(C(this.minY,this.minY*a+(1-a)*this.maxY,s),C(this.maxY,this.maxY*a+(1-a)*this.minY,s))).pow(2)}}class G extends D{constructor(t,e,s,i,a=0){super(t,e,s,i),this.grown=a}locus(t=Y){var e=t.x,s=t.z;if(0==this.grown)var i=t.y.sub(e.abs().mul(.2)).add(s.mul(1/6)),a=X(t.x.mul(2),t.y,t.z.min(0)).sub(X(0,this.pivot.y,0)).length().smoothstep(0,.13).pow(10);else i=t.y.sub(e.abs().mul(.2)).add(s.abs().mul(.5)),a=X(t.x.mul(2),t.y,t.z.min(0)).sub(X(0,this.pivot.y,0)).length().smoothstep(0,.065).pow(10);return v(a).mul(e.smoothstep(this.minX,this.maxX),C(this.minY,this.maxY,i).pow(2))}}class V{constructor(t,e){const s={LocusT:G,LocusX:_,LocusXY:D,LocusY:U};var i={};for(var a in e)if("_"!=a){var h=s[e[a][0]];i[a]=new h(t,...e[a].slice(1))}this._=e._,this.head=i.head,this.chest=i.chest,this.waist=i.waist,this.kneeLeft=i?.kneeLeft??i.knee,this.kneeRight=i?.kneeRight??i.knee.mirror(),this.ankleLeft=i?.ankleLeft??i.ankle,this.ankleRight=i?.ankleRight??i.ankle.mirror(),this.ankleLongLeft=i?.ankleLongLeft??i.ankleLong,this.ankleLongRight=i?.ankleLongRight??i.ankleLong.mirror(),this.legLongLeft=i?.legLongLeft??i.legLong,this.legLongRight=i?.legLongRight??i.legLong.mirror(),this.footLeft=i?.footLeft??i.foot,this.footRight=i?.footRight??i.foot.mirror(),this.legLeft=i?.legLeft??i.leg,this.legRight=i?.legRight??i.leg.mirror(),this.elbowLeft=i?.elbowLeft??i.elbow,this.elbowRight=i?.elbowRight??i.elbow.mirror(),this.forearmLeft=i?.forearmLeft??i.forearm,this.forearmRight=i?.forearmRight??i.forearm.mirror(),this.wristLeft=i?.wristLeft??i.wrist,this.wristRight=i?.wristRight??i.wrist.mirror(),this.armLeft=i?.armLeft??i.arm,this.armRight=i?.armRight??i.arm.mirror()}}var q,B,J,K,Q,$,tt,et,st=[];class it{constructor(t){if((q=new s({antialias:!0})).setSize(innerWidth,innerHeight),q.shadowMap.enabled=t?.shadows??!0,q.shadowMap.type=i,document.body.appendChild(q.domElement),document.body.style.overflow="hidden",document.body.style.margin="0",(B=new a).background=new h("whitesmoke"),(J=new n(30,innerWidth/innerHeight)).position.set(0,1,4),J.lookAt(0,1,0),t?.stats&&(et=new j,document.body.appendChild(et.dom)),(t?.lights??1)&&((K=new o("white",1.5)).decay=0,K.position.set(0,14,7),(t?.shadows??1)&&(K.shadow.mapSize.width=2048,K.shadow.mapSize.height=K.shadow.mapSize.width,K.shadow.camera.near=1,K.shadow.camera.far=50,K.shadow.camera.left=-5,K.shadow.camera.right=5,K.shadow.camera.top=5,K.shadow.camera.bottom=-5,K.shadow.normalBias=.01,K.autoUpdate=!1,K.castShadow=!0),B.add(K),(Q=new o("white",1.5)).decay=0,Q.target=B,J.add(Q),B.add(J)),(t?.controls??1)&&(($=new S(J,q.domElement)).enableDamping=!0,$.target.set(0,.8,0)),t?.ground??1){var e=document.createElement("CANVAS");e.width=128,e.height=128;var m=e.getContext("2d");m.fillStyle="white",m.filter="blur(10px)",m.beginPath(),m.arc(64,64,38,0,2*Math.PI),m.fill();var d=new r(new l(50),new g({color:"antiquewhite",transparent:!0,map:new c(e)}));d.receiveShadow=!0,d.rotation.x=-Math.PI/2,d.renderOrder=-1,B.add(d)}window.addEventListener("resize",(()=>{J.aspect=innerWidth/innerHeight,J.updateProjectionMatrix(),q.setSize(innerWidth,innerHeight)})),q.setAnimationLoop(nt)}}class at extends Event{#t;constructor(){super("animate")}get target(){return this.#t}set target(t){this.#t=t}}var ht=new at("animate");function nt(t){ht.time=t,window.dispatchEvent(ht),st.forEach((t=>{t.update(),t.dispatchEvent(ht)})),tt&&tt(t),$&&$.update(),et&&et.update(),q.render(B,J)}function ot(t){tt=t}var rt="man.glb",lt={head:["LocusY",[0,878,-37],[838,923],30],chest:["LocusY",[0,661,-8],[438,929],0,[40,300]],waist:["LocusY",[0,570,-9],[310,840]],leg:["LocusT",[41,546,-19],[-2,2],[690,441]],legLong:["LocusY",[39,0,-19],[700,140]],knee:["LocusY",[50,286,-23],[341,218],20],ankle:["LocusY",[41,51,-1],[97,10],-10],ankleLong:["LocusY",[51,206,-29],[430,-10]],foot:["LocusY",[0,20,12],[111,-185],120],elbow:["LocusX",[238,815,-40],[230,260],0],forearm:["LocusX",[170,815,-38],[46,490]],wrist:["LocusX",[375,820,-40],[354,402]],arm:["LocusXY",[85,790,-40],[30,150],[600,900]]},gt="woman.glb",ct={head:["LocusY",[0,872,-30],[827,919],30],chest:["LocusY",[0,661,-8],[438,929],0,[40,300]],waist:["LocusY",[0,570,-9],[350,840]],leg:["LocusT",[41,546,-19],[-2,2],[690,441]],legLong:["LocusY",[44,0,-19],[700,140]],knee:["LocusY",[50,286,-23],[341,218],20],ankle:["LocusY",[44,51,-4],[97,10],-10],ankleLong:["LocusY",[51,201,-29],[430,-33]],foot:["LocusY",[0,20,12],[111,-185],120],elbow:["LocusX",[238,815,-40],[230,260],0],forearm:["LocusX",[170,815,-38],[54,475]],wrist:["LocusX",[359,815,-34],[343,380]],arm:["LocusXY",[80,793,-40],[30,137],[600,900]]},mt="child.glb",dt={head:["LocusY",[0,850,-32],[807,894],30],chest:["LocusY",[0,640,1],[419,914],0,[40,300]],waist:["LocusY",[0,530,-7],[285,836]],leg:["LocusT",[40,521,-9],[-1,1],[625,430],1],legLong:["LocusY",[46,0,-5],[700,140]],knee:["LocusY",[50,288,-12],[346,221],20],ankle:["LocusY",[54,48,-14],[81,33],-10],ankleLong:["LocusY",[51,201,-25],[430,-33]],foot:["LocusY",[0,20,6],[83,-200],120],elbow:["LocusX",[249,793,-56],[230,273],0],forearm:["LocusX",[170,794,-59],[54,475]],wrist:["LocusX",[398,802,-57],[384,409]],arm:["LocusXY",[80,793,-40],[30,137],[600,900]]};const pt=import.meta.url.replace("/src/body.js","/assets/models/");var Lt=new u,[ft,ut,wt]=await Promise.all([Lt.loadAsync(pt+rt),Lt.loadAsync(pt+gt),Lt.loadAsync(pt+mt)]),xt=new m,Rt=new m,bt=new t,kt=t=>t*(2*Math.PI/360),Yt=t=>t/(2*Math.PI/360);function vt(t,e,s){Object.defineProperty(t,e,{get:()=>Yt(t.angle[s]),set(e){t.angle[s]=kt(e)}})}class yt extends L{constructor(t,e,s,i,a=i,h="xyz"){super(),this.model=t,this.isRight=e,this.parent=s,this.pivot=i.pivot,this.angle=i.angle,this.matrix=i.matrix,this.angleAux=a.angle,this.nameY=h[1],this.position.copy(i.pivot),vt(this,"bend",h[0]),vt(this,"raise",h[0]),vt(this,"tilt",h[2]),vt(this,"straddle",h[2]),vt(this,"foreward",h[0])}get turn(){return Yt(this.angleAux[this.nameY])}set turn(t){this.angleAux[this.nameY]=kt(t)}attach(t){t.parent&&(t=t.clone());var e=new L,s=new L;e.add(s),s.add(t),s.rotation.z=this.isRight?Math.PI:0,t.position.y*=this.isRight?-1:1,e.matrixAutoUpdate=!1,e.joint=this,this.model.children[0].add(e),this.model.accessories.push(e)}}var Xt=new d,zt=new p,Zt=1;class Mt extends L{constructor(s,i,a){super(),this.uid=Zt,Zt+=.3+2*Math.random(),this.castShadow=!0,this.receiveShadow=!0,this.accessories=[],this.dims={},this.space={};var h,n=new r(s.scene.children[0].geometry);!function(s,i){var a=new t,h=(new e).setFromObject(s,!0);h.getCenter(a),s.position.sub(a),i.x=a.x,i.y=h.min.y,i.z=a.z,h.getSize(a),i.scale=Math.max(...a),i.height=a.y}(n,this.dims),this.space=new V(this.dims,i),this.waist=new yt(this,!1,null,this.space.waist),this.chest=new yt(this,!1,this.waist,this.space.chest),this.head=new yt(this,!1,this.chest,this.space.head),this.legLeft=new yt(this,!1,this.waist,this.space.legLeft,this.space.legLongLeft),this.kneeLeft=new yt(this,!1,this.legLeft,this.space.kneeLeft),this.ankleLeft=new yt(this,!1,this.kneeLeft,this.space.ankleLeft,this.space.ankleLongLeft),this.footLeft=new yt(this,!1,this.ankleLeft,this.space.footLeft),this.legRight=new yt(this,!0,this.waist,this.space.legRight,this.space.legLongRight),this.kneeRight=new yt(this,!0,this.legRight,this.space.kneeRight),this.ankleRight=new yt(this,!0,this.kneeRight,this.space.ankleRight,this.space.ankleLongRight),this.footRight=new yt(this,!0,this.ankleRight,this.space.footRight),this.armLeft=new yt(this,!1,this.chest,this.space.armLeft,this.space.armLeft,"yxz"),this.elbowLeft=new yt(this,!1,this.armLeft,this.space.elbowLeft,this.space.elbowLeft,"yxz"),this.wristLeft=new yt(this,!1,this.elbowLeft,this.space.wristLeft,this.space.forearmLeft,"zxy"),this.armRight=new yt(this,!0,this.chest,this.space.armRight,this.space.armRight,"yxz"),this.elbowRight=new yt(this,!0,this.armRight,this.space.elbowRight,this.space.elbowRight,"yxz"),this.wristRight=new yt(this,!0,this.elbowRight,this.space.wristRight,this.space.forearmRight,"zxy"),n.material=new f({positionNode:(h={space:this.space},h.vertex=Y,h.fn=P,I(h)),normalNode:E({space:this.space}),colorNode:X(254/255,209/255,185/255).pow(2.2),metalness:0,roughness:.6}),a&&n.scale.setScalar(a/this.dims.height),n.castShadow=!0,n.receiveShadow=!0,this.model=n,this.torso=n,this.add(n),st.push(this),B&&B.add(this)}update(){function t(t,e,s,i,a,h){zt.set(s*e.x,i*e.y,a*e.z,h),Xt.makeRotationFromEuler(zt);var n=Xt.elements;t.value.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10])}for(var e of(t(this.space.head.matrix,this.space.head.angle,-1,-1,1,"YZX"),t(this.space.chest.matrix,this.space.chest.angle,-1,-1,1,"YZX"),t(this.space.waist.matrix,this.space.waist.angle,-1,1,1,"YZX"),t(this.space.elbowLeft.matrix,this.space.elbowLeft.angle,0,1,0,"YZX"),t(this.space.elbowRight.matrix,this.space.elbowRight.angle,0,-1,0,"YZX"),t(this.space.wristLeft.matrix,this.space.wristLeft.angle,0,1,1,"YZX"),t(this.space.wristRight.matrix,this.space.wristRight.angle,0,-1,-1,"YZX"),t(this.space.forearmLeft.matrix,this.space.forearmLeft.angle,-1,0,0,"YZX"),t(this.space.forearmRight.matrix,this.space.forearmRight.angle,-1,0,0,"YZX"),t(this.space.armLeft.matrix,this.space.armLeft.angle,-1,1,1,"XZY"),t(this.space.armRight.matrix,this.space.armRight.angle,-1,-1,-1,"XZY"),t(this.space.kneeLeft.matrix,this.space.kneeLeft.angle,-1,0,0,"YZX"),t(this.space.kneeRight.matrix,this.space.kneeRight.angle,-1,0,0,"YZX"),t(this.space.ankleLeft.matrix,this.space.ankleLeft.angle,-1,0,-1,"YZX"),t(this.space.ankleRight.matrix,this.space.ankleRight.angle,-1,0,1,"YZX"),t(this.space.ankleLongLeft.matrix,this.space.ankleLongLeft.angle,0,-1,0,"YZX"),t(this.space.ankleLongRight.matrix,this.space.ankleLongRight.angle,0,1,0,"YZX"),t(this.space.footLeft.matrix,this.space.footLeft.angle,-1,0,0,"YZX"),t(this.space.footRight.matrix,this.space.footRight.angle,-1,0,0,"YZX"),t(this.space.legLongLeft.matrix,this.space.legLongLeft.angle,0,-1,0,"YZX"),t(this.space.legLongRight.matrix,this.space.legLongRight.angle,0,1,0,"YZX"),t(this.space.legLeft.matrix,this.space.legLeft.angle,1,0,-1,"YZX"),t(this.space.legRight.matrix,this.space.legRight.angle,1,0,1,"YZX"),this.accessories)){var s=e.joint;for(Rt.identity(),bt.copy(s.pivot);s;s=s.parent)xt.copy(s.matrix.value).transpose(),Rt.premultiply(xt),bt.sub(s.pivot).applyMatrix3(xt).add(s.pivot);e.matrix.setFromMatrix3(Rt),e.matrix.setPosition(bt)}}}class St extends Mt{constructor(t){super(ft,lt,t),this.url=pt+rt,this.position.y=this.dims.height/2-.01,this.legLeft.straddle=5,this.legRight.straddle=5,this.ankleLeft.tilt=-5,this.ankleRight.tilt=-5,this.ankleLeft.bend=3,this.ankleRight.bend=3,this.armLeft.straddle=65,this.armRight.straddle=65,this.elbowLeft.bend=20,this.elbowRight.bend=20}}class jt extends Mt{constructor(t){super(ut,ct,t),this.url=pt+gt,this.position.y=this.dims.height/2-.005,this.legLeft.straddle=-2.9,this.legRight.straddle=-2.9,this.ankleLeft.tilt=2.9,this.ankleRight.tilt=2.9,this.ankleLeft.bend=3,this.ankleRight.bend=3,this.armLeft.straddle=65,this.armRight.straddle=65,this.elbowLeft.bend=20,this.elbowRight.bend=20}}class Pt extends Mt{constructor(t){super(wt,dt,t),this.url=pt+mt,this.position.y=this.dims.height/2-.005,this.ankleLeft.bend=3,this.ankleRight.bend=3,this.armLeft.straddle=65,this.armRight.straddle=65,this.elbowLeft.bend=20,this.elbowRight.bend=20}}console.log("%c\n⋮⋮⋮%cDISFIGURE\n\n","font-size:200%","font-size:150%; display:inline-block; padding:0.15em;");export{Pt as Child,St as Man,jt as Woman,it as World,J as camera,Q as cameraLight,O as chaotic,$ as controls,st as everybody,K as light,T as regular,q as renderer,B as scene,ot as setAnimationLoop};
