/*! disfigure v0.0.13 */
"use strict";var e=require("three"),t=require("three/addons/loaders/GLTFLoader.js"),s=require("three/tsl"),o=require("three/addons/math/SimplexNoise.js"),i=require("three/addons/controls/OrbitControls.js");function r(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(s){if("default"!==s){var o=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:function(){return e[s]}})}})),t.default=e,Object.freeze(t)}var n=r(e);const a=s.Fn((([e])=>{var t=e.cos(),o=e.sin();return s.mat3(1,0,0,0,t,o,0,o.negate(),t)}),{angle:"float",return:"mat3"}),h=s.Fn((([e])=>{var t=e.cos(),o=e.sin();return s.mat3(t,0,o.negate(),0,1,0,o,0,t)}),{angle:"float",return:"mat3"}),l=s.Fn((([e])=>{var t=e.cos(),o=e.sin();return s.mat3(t,o,0,o.negate(),t,0,0,0,1)}),{angle:"float",return:"mat3"});s.Fn((([e])=>{var t=a(e.x),s=h(e.y),o=l(e.z);return s.mul(t).mul(o)}),{angles:"vec3",return:"mat3"});const u=s.Fn((([e])=>{var t=a(e.x),s=h(e.y),o=l(e.z);return s.mul(o).mul(t)}),{angles:"vec3",return:"mat3"});s.Fn((([e])=>{var t=a(e.x),s=h(e.y),o=l(e.z);return t.mul(s).mul(o)}),{angles:"vec3",return:"mat3"});const m=s.Fn((([e])=>{var t=a(e.x),s=h(e.y),o=l(e.z);return t.mul(o).mul(s)}),{angles:"vec3",return:"mat3"});s.Fn((([e])=>{var t=a(e.x),s=h(e.y);return l(e.z).mul(t).mul(s)}),{angles:"vec3",return:"mat3"}),s.Fn((([e])=>{var t=a(e.x),s=h(e.y);return l(e.z).mul(s).mul(t)}),{angles:"vec3",return:"mat3"});const c=s.Fn((([e,t,s])=>s.smoothstep(e,t).smoothstep(0,1).smoothstep(0,1)),{edgeFrom:"float",edgeTo:"float",value:"float",return:"float"});s.Fn((()=>s.vec3(1)));var g=new o.SimplexNoise;var f=s.Fn((([e,t,o,i])=>e.sub(t).mul(u(o.mul(i,s.vec3(-1,-1,1)))).add(t)),{pos:"vec3",center:"vec3",angle:"vec3",amount:"float",return:"vec3"}),p=s.Fn((([e,t,o,i])=>e.sub(t).mul(m(o.mul(i,s.vec3(-1,-1,1)))).add(t).toVar()),{pos:"vec3",center:"vec3",angle:"vec3",amount:"float",return:"vec3"});function d(e){return e.vertex=s.positionGeometry,e.mode=s.float(1),v(e)}function L(e){return e.vertex=s.normalGeometry,e.mode=s.float(0),s.transformNormalToView(v(e)).xyz}var v=s.Fn((({space:e,posture:t,mode:o,vertex:i})=>{var r=i.toVar(),n=e.armLeft.locus().toVar();s.If(n.greaterThan(0),(()=>{r.assign(f(r,o.mul(e.wristLeft.pivot),t.wristLeft.mul(s.vec3(1,-1,1)),e.wristLeft.locus())),r.assign(f(r,o.mul(e.forearmLeft.pivot),t.forearmLeft,e.forearmLeft.locus())),r.assign(f(r,o.mul(e.elbowLeft.pivot),t.elbowLeft.mul(-1),e.elbowLeft.locus())),r.assign(p(r,o.mul(e.armLeft.pivot),t.armLeft.mul(s.vec3(1,-1,1)),e.armLeft.locus()))}));var a=e.armRight.locus().toVar();s.If(a.greaterThan(0),(()=>{r.assign(f(r,o.mul(e.wristRight.pivot),t.wristRight.mul(s.vec3(1,1,-1)),e.wristRight.locus())),r.assign(f(r,o.mul(e.forearmRight.pivot),t.forearmRight,e.forearmRight.locus())),r.assign(f(r,o.mul(e.elbowRight.pivot),t.elbowRight,e.elbowRight.locus())),r.assign(p(r,o.mul(e.armRight.pivot),t.armRight.mul(s.vec3(1,1,-1)),e.armRight.locus()))})),r.assign(f(r,o.mul(e.head.pivot),t.head,e.head.locus())),r.assign(f(r,o.mul(e.chest.pivot),t.chest,e.chest.locus())),r.assign(f(r,o.mul(e.waist.pivot),t.waist,e.waist.locus()));var h=e.legLeft.locus().toVar();s.If(h.greaterThan(0),(()=>{r.assign(f(r,o.mul(e.footLeft.pivot),t.footLeft,e.footLeft.locus())),r.assign(f(r,o.mul(e.ankleLeft.pivot),t.ankleLeft.mul(s.vec3(1,1,-1)),e.ankleLeft.locus())),r.assign(f(r,o.mul(e.ankleLongLeft.pivot),t.ankleLongLeft,e.ankleLongLeft.locus())),r.assign(f(r,o.mul(e.kneeLeft.pivot),t.kneeLeft,e.kneeLeft.locus())),r.assign(f(r,o.mul(e.legLongLeft.pivot),t.legLongLeft,e.legLongLeft.locus())),r.assign(f(r,o.mul(e.legLeft.pivot),t.legLeft.mul(s.vec3(-1,1,-1)),h))}));var l=e.legRight.locus().toVar();return s.If(l.greaterThan(0),(()=>{r.assign(f(r,o.mul(e.footRight.pivot),t.footRight,e.footRight.locus())),r.assign(f(r,o.mul(e.ankleRight.pivot),t.ankleRight,e.ankleRight.locus())),r.assign(f(r,o.mul(e.ankleLongRight.pivot),t.ankleLongRight.mul(-1),e.ankleLongRight.locus())),r.assign(f(r,o.mul(e.kneeRight.pivot),t.kneeRight,e.kneeRight.locus())),r.assign(f(r,o.mul(e.legLongRight.pivot),t.legLongRight.negate(),e.legLongRight.locus())),r.assign(f(r,o.mul(e.legRight.pivot),t.legRight.mul(s.vec3(-1,1,1)),l))})),r}));function w(e,t,s=0){return t*e/1e3+s}function x(t,s){return new e.Vector3(w(t[0],s.scale,s.x),w(t[1],s.scale,s.y),w(t[2],s.scale,s.z))}function R(e){var t=Object.assign(Object.create(e),e);return t.pivot=t.pivot.clone(),t.pivot.x*=-1,t}class b{constructor(e,t,s,o=0,i){this.pivot=x(t,e),this.minY=w(s[0],e.scale,e.y),this.maxY=w(s[1],e.scale,e.y),i&&(this.minX=w(i[0],e.scale,e.x),this.maxX=w(i[1],e.scale,e.x)),this.slope=Math.tan((90-o)*Math.PI/180)}mirror(){var e=R(this);return"minX"in e&&(e.minX*=-1,e.maxX*=-1),e}locus(e=s.positionGeometry){var t=e.x,o=e.y,i=e.z;0!=this.angle&&(o=o.add(i.sub(this.pivot.z).div(this.slope)));var r=c(this.minY,this.maxY,o);return"minX"in this&&(r=r.max(c(this.minX,this.maxX,t.abs().add(o.sub(this.pivot.y))))),r}}class k{constructor(e,t,s,o=0){this.pivot=x(t,e),this.minX=w(s[0],e.scale,e.x),this.maxX=w(s[1],e.scale,e.x),this.slope=Math.tan((90-o)*Math.PI/180)}mirror(){var e=R(this);return e.minX*=-1,e.maxX*=-1,e}locus(e=s.positionGeometry){var t=e.x,o=e.z,i=s.float(this.minX),r=s.float(this.maxX);if(0!=this.angle){var n=o.sub(this.pivot.z).div(this.slope).max(.01).mul(t.sign());i=i.sub(n),r=r.add(n)}return c(i,r,t)}}class y extends k{constructor(e,t,s,o){super(e,t,s),this.minY=w(o[0],e.scale,e.y),this.maxY=w(o[1],e.scale,e.y)}locus(e=s.positionGeometry){var t=e.x,o=e.y,i=e.y.sub(this.pivot.y).div(4,t.sign()),r=.8;return s.float(1).mul(c(s.float(this.minX).sub(i),s.float(this.maxX).sub(i),t)).mul(s.min(c(this.minY,this.minY*r+(1-r)*this.maxY,o),c(this.maxY,this.maxY*r+(1-r)*this.minY,o))).pow(2)}}class Y extends y{constructor(e,t,s,o,i=0){super(e,t,s,o),this.grown=i}locus(e=s.positionGeometry){var t=e.x,o=e.z;if(0==this.grown)var i=e.y.sub(t.abs().mul(.2)).add(o.mul(1/6)),r=s.vec3(e.x.mul(2),e.y,e.z.min(0)).sub(s.vec3(0,this.pivot.y,0)).length().smoothstep(0,.13).pow(10);else i=e.y.sub(t.abs().mul(.2)).add(o.abs().mul(.5)),r=s.vec3(e.x.mul(2),e.y,e.z.min(0)).sub(s.vec3(0,this.pivot.y,0)).length().smoothstep(0,.065).pow(10);return s.float(r).mul(t.smoothstep(this.minX,this.maxX),c(this.minY,this.maxY,i).pow(2))}}class X{constructor(e,t){const s={LocusT:Y,LocusX:k,LocusXY:y,LocusY:b};var o={};for(var i in t)if("_"!=i){var r=s[t[i][0]];o[i]=new r(e,...t[i].slice(1))}this._=t._,this.head=o.head,this.chest=o.chest,this.waist=o.waist,this.kneeLeft=o?.kneeLeft??o.knee,this.kneeRight=o?.kneeRight??o.knee.mirror(),this.ankleLeft=o?.ankleLeft??o.ankle,this.ankleRight=o?.ankleRight??o.ankle.mirror(),this.ankleLongLeft=o?.ankleLongLeft??o.ankleLong,this.ankleLongRight=o?.ankleLongRight??o.ankleLong.mirror(),this.legLongLeft=o?.legLongLeft??o.legLong,this.legLongRight=o?.legLongRight??o.legLong.mirror(),this.footLeft=o?.footLeft??o.foot,this.footRight=o?.footRight??o.foot.mirror(),this.legLeft=o?.legLeft??o.leg,this.legRight=o?.legRight??o.leg.mirror(),this.elbowLeft=o?.elbowLeft??o.elbow,this.elbowRight=o?.elbowRight??o.elbow.mirror(),this.forearmLeft=o?.forearmLeft??o.forearm,this.forearmRight=o?.forearmRight??o.forearm.mirror(),this.wristLeft=o?.wristLeft??o.wrist,this.wristRight=o?.wristRight??o.wrist.mirror(),this.armLeft=o?.armLeft??o.arm,this.armRight=o?.armRight??o.arm.mirror()}}exports.renderer=void 0,exports.scene=void 0,exports.camera=void 0,exports.light=void 0,exports.cameraLight=void 0,exports.controls=void 0;var z,j=[];class S extends Event{#e;constructor(){super("animate")}get target(){return this.#e}set target(e){this.#e=e}}var M=new S("animate");function F(e){M.time=e,window.dispatchEvent(M),j.forEach((e=>{e.dispatchEvent(M)})),z&&z(e),exports.controls&&exports.controls.update(),exports.renderer.render(exports.scene,exports.camera)}var N=Object.freeze({__proto__:null,SPACE:{head:["LocusY",[0,878,-37],[838,923],30],chest:["LocusY",[0,661,-8],[438,929],0,[40,300]],waist:["LocusY",[0,570,-9],[310,840]],leg:["LocusT",[41,546,-19],[-2,2],[690,441]],legLong:["LocusY",[39,0,-19],[700,140]],knee:["LocusY",[50,286,-23],[341,218],20],ankle:["LocusY",[41,51,-1],[97,10],-10],ankleLong:["LocusY",[51,206,-29],[430,-10]],foot:["LocusY",[0,20,12],[111,-185],120],elbow:["LocusX",[238,815,-40],[230,260],0],forearm:["LocusX",[170,815,-38],[46,490]],wrist:["LocusX",[375,820,-40],[354,402]],arm:["LocusXY",[85,790,-40],[30,150],[600,900]]},URL:"man.glb"}),C=Object.freeze({__proto__:null,SPACE:{head:["LocusY",[0,872,-30],[827,919],30],chest:["LocusY",[0,661,-8],[438,929],0,[40,300]],waist:["LocusY",[0,570,-9],[350,840]],leg:["LocusT",[41,546,-19],[-2,2],[690,441]],legLong:["LocusY",[44,0,-19],[700,140]],knee:["LocusY",[50,286,-23],[341,218],20],ankle:["LocusY",[44,51,-4],[97,10],-10],ankleLong:["LocusY",[51,201,-29],[430,-33]],foot:["LocusY",[0,20,12],[111,-185],120],elbow:["LocusX",[238,815,-40],[230,260],0],forearm:["LocusX",[170,815,-38],[54,475]],wrist:["LocusX",[359,815,-34],[343,380]],arm:["LocusXY",[80,793,-40],[30,137],[600,900]]},URL:"woman.glb"}),P=Object.freeze({__proto__:null,SPACE:{head:["LocusY",[0,850,-32],[807,894],30],chest:["LocusY",[0,640,1],[419,914],0,[40,300]],waist:["LocusY",[0,530,-7],[285,836]],leg:["LocusT",[40,521,-9],[-1,1],[625,430],1],legLong:["LocusY",[46,0,-5],[700,140]],knee:["LocusY",[50,288,-12],[346,221],20],ankle:["LocusY",[54,48,-14],[81,33],-10],ankleLong:["LocusY",[51,201,-25],[430,-33]],foot:["LocusY",[0,20,6],[83,-200],120],elbow:["LocusX",[249,793,-56],[230,273],0],forearm:["LocusX",[170,794,-59],[54,475]],wrist:["LocusX",[398,802,-57],[384,409]],arm:["LocusXY",[80,793,-40],[30,137],[600,900]]},URL:"child.glb"});var O=new t.GLTFLoader;function _(e){return 2*(e=(e=(e%360+360)%360)>180?e-360:e)*Math.PI/360}class E{constructor(e,t,s,o,i="x",r="y",n="z"){this.isRight=e,this.jointX=t,this.jointY=s??t,this.jointZ=o??t,this.nameX=i,this.nameY=r,this.nameZ=n}get nod(){return this.jointX.value.x}set nod(e){this.jointX.value.x=_(e)}get bend(){return this.jointX.value[this.nameX]}set bend(e){this.jointX.value[this.nameX]=_(e)}get raise(){return this.jointX.value[this.nameX]}set raise(e){this.jointX.value[this.nameX]=_(e)}get turn(){return this.jointY.value[this.nameY]}set turn(e){this.jointY.value[this.nameY]=_(e)}get tilt(){return this.jointZ.value[this.nameZ]}set tilt(e){this.jointZ.value[this.nameZ]=_(e)}get straddle(){return this.jointZ.value[this.nameZ]}set straddle(e){this.jointZ.value[this.nameZ]=_(e)}}class T extends n.Group{constructor(t,o){super(),this.uid=10*Math.random(),this.castShadow=!0,this.receiveShadow=!0,this.dims={},this.posture=(t.SPACE,{head:s.uniform(s.vec3(0,0,0)),chest:s.uniform(s.vec3(0,0,0)),waist:s.uniform(s.vec3(0,0,0)),kneeLeft:s.uniform(s.vec3(0,0,0)),kneeRight:s.uniform(s.vec3(0,0,0)),ankleLeft:s.uniform(s.vec3(0,0,0)),ankleRight:s.uniform(s.vec3(0,0,0)),footLeft:s.uniform(s.vec3(0,0,0)),footRight:s.uniform(s.vec3(0,0,0)),legLeft:s.uniform(s.vec3(0,0,0)),legLongLeft:s.uniform(s.vec3(0,0,0)),legRight:s.uniform(s.vec3(0,0,0)),legLongRight:s.uniform(s.vec3(0,0,0)),ankleLongLeft:s.uniform(s.vec3(0,0,0)),ankleLongRight:s.uniform(s.vec3(0,0,0)),elbowLeft:s.uniform(s.vec3(0,0,0)),elbowRight:s.uniform(s.vec3(0,0,0)),forearmLeft:s.uniform(s.vec3(0,0,0)),forearmRight:s.uniform(s.vec3(0,0,0)),wristLeft:s.uniform(s.vec3(0,0,0)),wristRight:s.uniform(s.vec3(0,0,0)),armLeft:s.uniform(s.vec3(0,0,0)),armRight:s.uniform(s.vec3(0,0,0))}),this.head=new E(!1,this.posture.head),this.chest=new E(!1,this.posture.chest),this.waist=new E(!1,this.posture.waist),this.legLeft=new E(!1,this.posture.legLeft,this.posture.legLongLeft),this.kneeLeft=new E(!1,this.posture.kneeLeft),this.ankleLeft=new E(!1,this.posture.ankleLeft,this.posture.ankleLongLeft),this.footLeft=new E(!1,this.posture.footLeft),this.legRight=new E(!0,this.posture.legRight,this.posture.legLongRight),this.kneeRight=new E(!0,this.posture.kneeRight),this.ankleRight=new E(!0,this.posture.ankleRight,this.posture.ankleLongRight),this.footRight=new E(!0,this.posture.footRight),this.armLeft=new E(!1,this.posture.armLeft,this.posture.armLeft,this.posture.armLeft,"y","x","z"),this.elbowLeft=new E(!1,this.posture.elbowLeft,null,null,"y"),this.wristLeft=new E(!1,this.posture.wristLeft,this.posture.forearmLeft,this.posture.wristLeft,"z","x","y"),this.armRight=new E(!0,this.posture.armRight,this.posture.armRight,this.posture.armRight,"y","x","z"),this.elbowRight=new E(!0,this.posture.elbowRight,null,null,"y"),this.wristRight=new E(!0,this.posture.wristRight,this.posture.forearmRight,this.posture.wristRight,"z","x","y"),O.load("../assets/models/"+t.URL,(i=>{var r=function(t){var s=[];t.traverse((t=>{if(t.isMesh){var o=t.geometry.clone().applyMatrix4(t.matrixWorld),i=t.material.clone(),r=new e.Mesh(o,i);r.frustumCulled=!1,s.push(r)}}));var o=new e.Group;return o.add(...s),o}(i.scene);!function(t,s){var o=new e.Vector3,i=(new e.Box3).setFromObject(t,!0);i.getCenter(o),t.position.sub(o),s.x=(i.max.x+i.min.x)/2,s.y=i.min.y,s.z=(i.max.z+i.min.z)/2,s.scale=Math.max(i.max.x-i.min.x,i.max.y-i.min.y,i.max.z-i.min.z),s.height=i.max.y-i.min.y}(r,this.dims),function(t,s,o,i,r){t.traverse((t=>{if(t.isMesh){var n=new e.MeshPhysicalNodeMaterial;Object.assign(n,t.material),Object.assign(n,r),i.colorNode&&(n.colorNode=i.colorNode()),i.positionNode&&(n.positionNode=i.positionNode({space:s,posture:o})),i.normalNode&&(n.normalNode=i.normalNode({space:s,posture:o})),i.emissiveNode&&(n.emissiveNode=i.emissiveNode({space:s,posture:o})),t.material=n,t.castShadow=!0,t.receiveShadow=!0}}))}(r,new X(this.dims,t.SPACE),this.posture,{positionNode:d,normalNode:L,colorNode:s.Fn((()=>s.vec3(254/255,209/255,185/255).pow(2.2)))},{metalness:0,roughness:.6}),r.position.y=-this.dims.y/2,o&&r.scale.setScalar(o/this.dims.height),r.castShadow=!0,r.receiveShadow=!0,this.add(r),j.push(this),exports.scene&&exports.scene.add(this)}))}}exports.Child=class extends T{constructor(e){super(P,e),this.ankleLeft.bend=3,this.ankleRight.bend=3,this.position.y=-.005,this.armLeft.straddle=65,this.armRight.straddle=65,this.elbowLeft.bend=20,this.elbowRight.bend=20}},exports.Man=class extends T{constructor(e){super(N,e),this.legLeft.straddle=5,this.legRight.straddle=5,this.ankleLeft.tilt=-5,this.ankleRight.tilt=-5,this.ankleLeft.bend=3,this.ankleRight.bend=3,this.position.y=-.005,this.armLeft.straddle=65,this.armRight.straddle=65,this.elbowLeft.bend=20,this.elbowRight.bend=20}},exports.Woman=class extends T{constructor(e){super(C,e),this.legLeft.straddle=-2.9,this.legRight.straddle=-2.9,this.ankleLeft.tilt=2.9,this.ankleRight.tilt=2.9,this.ankleLeft.bend=3,this.ankleRight.bend=3,this.position.y=-.005,this.armLeft.straddle=65,this.armRight.straddle=65,this.elbowLeft.bend=20,this.elbowRight.bend=20}},exports.World=class{constructor(t){if(exports.renderer=new e.WebGPURenderer({antialias:!0}),exports.renderer.setSize(innerWidth,innerHeight),exports.renderer.shadowMap.enabled=t?.shadows??!0,exports.renderer.shadowMap.type=e.PCFSoftShadowMap,document.body.appendChild(exports.renderer.domElement),document.body.style.overflow="hidden",document.body.style.margin="0",exports.scene=new e.Scene,exports.scene.background=new e.Color("whitesmoke"),exports.camera=new e.PerspectiveCamera(30,innerWidth/innerHeight),exports.camera.position.set(0,1,4),exports.camera.lookAt(0,1,0),(t?.lights??1)&&(exports.light=new e.DirectionalLight("white",1.5),exports.light.decay=0,exports.light.position.set(0,14,7),(t?.shadows??1)&&(exports.light.shadow.mapSize.width=2048,exports.light.shadow.mapSize.height=exports.light.shadow.mapSize.width,exports.light.shadow.camera.near=1,exports.light.shadow.camera.far=50,exports.light.shadow.camera.left=-5,exports.light.shadow.camera.right=5,exports.light.shadow.camera.top=5,exports.light.shadow.camera.bottom=-5,exports.light.shadow.normalBias=.01,exports.light.autoUpdate=!1,exports.light.castShadow=!0),exports.scene.add(exports.light),exports.cameraLight=new e.DirectionalLight("white",1.5),exports.cameraLight.decay=0,exports.cameraLight.target=exports.scene,exports.camera.add(exports.cameraLight),exports.scene.add(exports.camera)),(t?.controls??1)&&(exports.controls=new i.OrbitControls(exports.camera,exports.renderer.domElement),exports.controls.enableDamping=!0,exports.controls.target.set(0,.8,0)),t?.ground??1){var s=document.createElement("CANVAS");s.width=128,s.height=128;var o=s.getContext("2d");o.fillStyle="white",o.filter="blur(10px)",o.beginPath(),o.arc(64,64,37.5,0,2*Math.PI),o.fill();var r=new e.Mesh(new e.CircleGeometry(50),new e.MeshLambertMaterial({color:"antiquewhite",transparent:!0,map:new e.CanvasTexture(s)}));r.receiveShadow=!0,r.rotation.x=-Math.PI/2,r.renderOrder=-1,exports.scene.add(r)}window.addEventListener("resize",(()=>{exports.camera.aspect=innerWidth/innerHeight,exports.camera.updateProjectionMatrix(),exports.renderer.setSize(innerWidth,innerHeight)})),exports.renderer.setAnimationLoop(F)}},exports.chaotic=function(e,t=0,s=-1,o=1){return s+(o-s)*(g.noise(e,t)+1)/2},exports.everybody=j,exports.regular=function(e,t=0,s=-1,o=1){return s+(o-s)*(Math.sin(e+t)+1)/2},exports.setAnimationLoop=function(e){z=e};
