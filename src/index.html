<!DOCTYPE html>


<html>


<head>
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

	<style>
		body { margin: 0 }
	</style>
	
	<script type="importmap">
	  {
		"imports": {
			"three": "https://cdn.jsdelivr.net/npm/three@0.175.0/build/three.webgpu.min.js",
			"three/webgpu": "https://cdn.jsdelivr.net/npm/three@0.175.0/build/three.webgpu.min.js",
			"three/tsl": "https://cdn.jsdelivr.net/npm/three@0.175.0/build/three.tsl.min.js",
			"three/addons/": "https://cdn.jsdelivr.net/npm/three@0.175.0/examples/jsm/"
		}
	  }
	</script>
</head>


<body>
	<script type="module">

import * as THREE from "three";
import { float, uniform, vec2, vec3, vec4 } from "three/tsl";
import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
import { createGui, scene } from "./disfigure-gui.js";
import { processModel } from "./disfigure-model.js";


console.clear( );


const MODEL_URL = 'models/mc-powerful-deep-chestnut-bougainvillea-t-pose.glb';


var overModel = new THREE.Object3D();
scene.add( overModel );


new GLTFLoader().load( MODEL_URL, ( gltf ) => {

	var model = processModel( gltf.scene, posture );

	createGui( posture, model );

	overModel.add( model );

} );





var posture = {

	// debug section
	select: uniform( float( 0 ) ),
	isolated: uniform( float( 1 ) ), // 0 or 1

	// normal section
	
	// TORSO
	headPos: vec3( 0, 2.56, -0.02 ),
	headSpan: vec2( 2.51, 2.64 ),
	headTurn: uniform( vec3( 0, 0, 0 ) ),

	chestPos: vec3( 0, 2.3, 0 ),
	chestSpan: vec2( 2.1, 2.4 ),
	chestTurn: uniform( vec3( 0, 0, 0 ) ),

	waistPos: vec3( 0, 2.1, 0 ),
	waistSpan: vec2( 1.9, 2.4 ),
	waistTurn: uniform( vec3( 0, 0, 0 ) ),

	// LEGS
	kneeLeftPos: vec3( 0.08, 1.655, -0.01 ),
	kneeLeftSpan: vec2( 1.7, 1.6 ),
	kneeLeftTurn: uniform( vec3( 0, 0, 0 ) ),

	kneeRightPos: vec3( -0.08, 1.655, -0.01 ),
	kneeRightSpan: vec2( 1.7, 1.6 ),
	kneeRightTurn: uniform( vec3( 0, 0, 0 ) ),

	ankleLeftPos: vec3( 0.085, 1.29, -0.07 ),
	ankleLeftSpan: vec2( 1.35, 1.22 ),
	ankleLeftTurn: uniform( vec3( 0, 0, 0 ) ),

	ankleRightPos: vec3( -0.085, 1.29, -0.07 ),
	ankleRightSpan: vec2( 1.35, 1.22 ),
	ankleRightTurn: uniform( vec3( 0, 0, 0 ) ),

//	legLeftPos: vec3( 0.07, 2.10, -0.05 ),
//	legLeftSpan: vec2( 2.0, 1.7 ),
	legLeftPos: uniform(vec3( 0.052, 2, -0.04 )),
//	legLeftSpan: uniform(vec2( 2.146, 1.866 )),
	legLeftSpan: uniform(vec2( 2.1, 1.9 )),
	legLeftTurn: uniform( vec3( 0, 0, 0 ) ),

//	legRightPos: vec3( -0.07, 2.10, -0.05 ),
//	legRightSpan: vec2( 2.2, 1.75 ),
//	legRightTurn: uniform( vec3( 0, 0, 0 ) ),
	legRightPos: vec3( -0.052, 2, -0.04 ),
	legRightSpan: vec2( 2.1, 1.9 ),
	legRightTurn: uniform( vec3( 0, 0, 0 ) ),

			elbowLeftPos: vec3( 42, 125, -5 ),
			elbowLeftSpan: vec2( 39, 46 ),
			elbowLeftTurn: uniform( vec3( 0, 0, 0 ) ),

			elbowRightPos: vec3( -42, 125, -5 ),
			elbowRightSpan: vec2( -39, -46 ),
			elbowRightTurn: uniform( vec3( 0, 0, 0 ) ),

			forearmLeftPos: vec3( 42, 125, -5 ),
			forearmLeftSpan: vec2( 40, 70 ),
			forearmLeftTurn: uniform( vec3( 0, 0, 0 ) ),

			forearmRightPos: vec3( -42, 125, -5 ),
			forearmRightSpan: vec2( -40, -70 ),
			forearmRightTurn: uniform( vec3( 0, 0, 0 ) ),

			wristLeftPos: vec3( 68, 123, -6 ),
			wristLeftSpan: vec2( 67, 74 ),
			wristLeftTurn: uniform( vec3( 0, 0, 0 ) ),

			wristRightPos: vec3( -68, 123, -6 ),
			wristRightSpan: vec2( -67, -74 ),
			wristRightTurn: uniform( vec3( 0, 0, 0 ) ),

			armLeftPos: ( vec3( 12, 124, -5 ) ),
			armLeftSpan: ( vec4( 8, 16, 144, 1.4 ) ),
			armLeftTurn: uniform( vec3( 0, 0, 0 ) ),

			armRightPos: ( vec3( -12, 124, -5 ) ),
			armRightSpan: ( vec4( -8, -16, 144, -1.4 ) ),
			armRightTurn: uniform( vec3( 0, 0, 0 ) ),

};


	</script>
</body>
</html>