<!DOCTYPE html>

<html>

<body>
	<header>
		<h1><b>Disfigure</b></h1>
		<h3>Combining slices into more complex slices</h3></br>
	</header>

	<div id="spinner"></div>

	<script src="importmap.js"></script>
	<script type="module">

		import * as Happy from 'disfigure';


		// create a default world

		new Happy.World( );


		// create three persons

		var man = new Happy.Man(),
			woman = new Happy.Woman(),
			child = new Happy.Child();

		man.position.x = 0.75;
		woman.position.x = -0.75;


		// define clothing
		man.dress([
			Happy.velour( 'WhiteSMoke' ),
		
			Happy.slice( 1-0.1, 1+0.3, { angle: 45, wave: 0.3, width: 0.02 } )
				.and( Happy.slice( 1-0.1+0.2, 1+0.3+0.2, { angle: -45, wave: 0.3, width: 0.02 } ) ),
			Happy.latex( 'black' ),
		
			Happy.slice( -0.1, 0.8+0.3, { angle: 45, wave: 0.3, width: 0.02 } )
				.and( Happy.slice( -0.1-0.2, 0.8+0.3-0.2, { angle: -45, wave: 0.3, width: 0.02 } ) )
				.or( Happy.slice( -0.2, 0.2 ) ),
			Happy.latex( 'black' ),
		
		]);
		
		woman.dress([
			Happy.velour( 'WhiteSMoke' ),

			Happy.slice( 1-0.1, 1+0.3, { angle: 30, wave: 0.2, width: 0.1 } )
				.or( Happy.slice( 1-0.1, 1+0.3, { angle: -30, wave: 0.2, width: 0.1 } ) ),
			Happy.latex( 'black' ),
		]);
		
		var left = Happy.slice( 0.2, 0.3, { angle: 45 } )
			.or( Happy.slice( 0.4, 0.5, { angle: 45 } ) )
			.or( Happy.slice( 0.6, 0.7, { angle: 45 } ) )
			.or( Happy.slice( 0.8, 0.9, { angle: 45 } ) )
			.or( Happy.slice( 1.0, 1.1, { angle: 45 } ) );
		
		var right = Happy.slice( 0.2, 0.3, { angle: -45 } )
			.or( Happy.slice( 0.4, 0.5, { angle: -45 } ) )
			.or( Happy.slice( 0.6, 0.7, { angle: -45 } ) )
			.or( Happy.slice( 0.8, 0.9, { angle: -45 } ) )
			.or( Happy.slice( 1.0, 1.1, { angle: -45 } ) );

		
		child.dress([
			Happy.velour( 'WhiteSMoke' ),

			Happy.slice( 0.74, 0.76, { angle: 45 } )
				.or( Happy.slice( 0.74, 0.76, { angle: -45 } ) )
				.and( Happy.slice( 0.5, 1.0 ) ),
			Happy.velour( 'crimson' ),
		
		
			left.and( right ),
			Happy.velour( 'black' ),
		]);
		
		
		// animate the arms
		
		function animate( event ) {

			var someone = event.target;
			var t = event.time/2000 + 10*someone.uid;

			// arms
		
			someone.l_arm.straddle = Happy.chaotic( t, 5, 70, 80 );
			someone.l_arm.turn = Happy.chaotic( t, 6, -10, 70 );

			someone.r_arm.straddle = Happy.chaotic( t, -5, 70, 80 );
			someone.r_arm.turn = Happy.chaotic( t, -6, -10, 70 );

			someone.l_elbow.bend = Happy.chaotic( t, 9, 0, 40 );
			someone.r_elbow.bend = Happy.chaotic( t, 7, 0, 40 );

			someone.l_forearm.turn = Happy.chaotic( t, 11, -15, 15 );
			someone.r_forearm.turn = Happy.chaotic( t, -8, -15, 15 );

			someone.l_wrist.bend = Happy.chaotic( t, -2, -20, 20 );
			someone.l_wrist.tilt = Happy.chaotic( t, -5, -20, 20 );

			someone.r_wrist.bend = Happy.chaotic( t, -1, -20, 20 );
			someone.r_wrist.tilt = Happy.chaotic( t, -4, -20, 20 );

			// body
		
			someone.head.bend = Happy.chaotic( t/5, 3, -10, 10 );
			someone.head.turn = Happy.chaotic( t/2, 2, -40, 40 );
			someone.head.tilt = Happy.chaotic( t/2, 1, -20, 20 );
			someone.waist.turn = -someone.head.turn;
		
		}

		man.addEventListener( 'animate', animate );
		woman.addEventListener( 'animate', animate );
		child.addEventListener( 'animate', animate );

	</script>
</body>
</html>