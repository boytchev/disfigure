<!DOCTYPE html>

<html>

<body>
	<header>
		<h1><b>Disfigure</b></h1>
		<h3>Attaching accessories to the body</h3></br>
	</header>

	<div id="spinner"></div>

	<script src="importmap.js"></script>
	<script type="module">

		import * as Three from 'three';
		import * as Happy from 'disfigure';


		// create a default world

		new Happy.World();
		Happy.camera.position.set( 0, 1.85, 2 );
		Happy.controls.target.set( 0, 1.35, 0 );
		

		// create a man

		var man = new Happy.Man( );

		var spike = new Three.Mesh(
			new Three.ConeGeometry( 0.02, 0.1 ),
			new Three.MeshPhysicalMaterial( {metalness:0.9, roughness:0.3} ),
		);
		
		man.l_arm.attach( spike, 0.1, 0.1, 0 );
		man.l_arm.attach( spike, 0.15, 0.1, 0 );
		man.l_arm.attach( spike, 0.2, 0.1, 0 );
		man.l_arm.attach( spike, 0.25, 0.1, 0 );
		man.l_forearm.attach( spike, -0.08, 0.06, -0.002 );
		man.l_forearm.attach( spike, -0.03, 0.06, -0.004 );
		man.l_forearm.attach( spike, 0.02, 0.055, -0.006 );
		man.l_forearm.attach( spike, 0.07, 0.05, -0.008 );
		man.l_forearm.attach( spike, 0.12, 0.045, -0.01 );
		
		man.r_arm.attach( spike, -0.1, 0.1, 0 );
		man.r_arm.attach( spike, -0.15, 0.1, 0 );
		man.r_arm.attach( spike, -0.2, 0.1, 0 );
		man.r_arm.attach( spike, -0.25, 0.1, 0 );
		man.r_forearm.attach( spike, 0.08, 0.06, -0.002 );
		man.r_forearm.attach( spike, 0.03, 0.06, -0.004 );
		man.r_forearm.attach( spike, -0.02, 0.055, -0.006 );
		man.r_forearm.attach( spike, -0.07, 0.05, -0.008 );
		man.r_forearm.attach( spike, -0.12, 0.045, -0.01 );
		
		
		// animate the scene
		
		Happy.setAnimationLoop( ( t )=>{

			t=t/4000;
		
			// animating the man

			man.head.bend = Happy.chaotic( t, 0, -30, 50 );
			man.head.turn = Happy.chaotic( t, 4, -60, 60 );
			man.head.tilt = Happy.chaotic( t, 2, -50, 50 );

			man.chest.bend = Happy.chaotic( t, 1, -20, 40 );
			man.chest.turn = Happy.chaotic( t, 6, -60, 60 );
			man.chest.tilt = Happy.chaotic( t, 6, -30, 30 );

			man.waist.bend = Happy.chaotic( t, 3, -20, 40 );
			man.waist.turn = Happy.chaotic( t, 5, -60, 60 );
			man.waist.tilt = Happy.chaotic( t, 6, -30, 30 );

			man.l_elbow.bend = Happy.chaotic( t, 9, 0, 140 );
			man.r_elbow.bend = Happy.chaotic( t, 7, 0, 140 );

			man.l_wrist.bend = Happy.chaotic( t, -2, -60, 60 );
			man.l_wrist.turn = Happy.chaotic( t, -3, -45, 45 );
			man.l_wrist.tilt = Happy.chaotic( t, -2, -40, 40 );

			man.r_wrist.bend = Happy.chaotic( t, -1, -60, 60 );
			man.r_wrist.turn = Happy.chaotic( t, -4, -45, 45 );
			man.r_wrist.tilt = Happy.chaotic( t, -1, -40, 40 );

			man.l_arm.straddle = Happy.chaotic( t, 5, -50, 40 );
			man.l_arm.turn = Happy.chaotic( t, 6, -20, 20 );
			man.l_arm.foreward = Happy.chaotic( t, 7, -20, 80 );

			man.r_arm.straddle = Happy.chaotic( t, -5, -50, 40 );
			man.r_arm.turn = Happy.chaotic( t, -6, -20, 20 );
			man.r_arm.foreward = Happy.chaotic( t, -7, -20, 80 );

		} );
		
	</script>
</body>
</html>